facet_grid(t2.clim.bin~sm.clim.bin) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous('Standardized bias in Y_var (ERA - obs)') +
scale_x_continuous('Bias in LAI (ERA - obs)') +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank())
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
source('~/work/workspace/f4p-era5-analysis/code/mkplots___perVar.R')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___perVar.R')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___perVar.R')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___perVar.R')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___perVar.R')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___perVar.R')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___forSouthAmerica.R')
head(df_all_comb)
dim(df_all_comb)
climbin_labeller <- labeller(
t2.clim.bin = label_both, sm.clim.bin = label_value)
varname <- 'SM'
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous('Standardized bias in Y_var (ERA - obs)') +
scale_x_continuous('Bias in LAI (ERA - obs)') +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank())
g_plots
unique(df_all_comb$t2.clim.bin)
levels(df_all_comb$t2.clim.bin)
levels(df_all_comb$t2.clim.bin)
conservation_status <- c(
cd = "Conservation Dependent",
en = "Endangered",
lc = "Least concern",
nt = "Near Threatened",
vu = "Vulnerable",
domesticated = "Domesticated"
)
conservation_status
t2.clim.bin.labels <- as.numeric(levels(df_all_comb$t2.clim.bin))
t2.clim.bin.labels
t2.clim.bin.values <- as.numeric(levels(df_all_comb$t2.clim.bin))
t2.clim.bin.values
diff(t2.clim.bin.values)
unique(diff(t2.clim.bin.values))
unique(diff(t2.clim.bin.values))/2
t2.binwidth <- unique(diff(t2.clim.bin.values))/2
t2.clim.bin.labels <- paste(t2.clim.bin.values - t2.binwidth, '<= t2 <',
t2.clim.bin.values + t2.binwidth, collapse = T)
t2.clim.bin.labels <- paste(t2.clim.bin.values - t2.binwidth, '<= t2 <',
t2.clim.bin.values + t2.binwidth, collapse)
t2.clim.bin.labels <- paste(t2.clim.bin.values - t2.binwidth, '<= t2 <',
t2.clim.bin.values + t2.binwidth)
t2.clim.bin.labels
names(t2.clim.bin.labels) <- levels(df_all_comb$t2.clim.bin)
t2.clim.bin.labels
t2.clim.bin.values <- as.numeric(levels(df_all_comb$t2.clim.bin))
t2.binwidth <- unique(diff(t2.clim.bin.values))/2
t2.clim.bin.labels <- paste(t2.clim.bin.values - t2.binwidth, '<= t2 <',
t2.clim.bin.values + t2.binwidth)
names(t2.clim.bin.labels) <- levels(df_all_comb$t2.clim.bin)
climbin_labeller <- labeller(
t2.clim.bin = t2.clim.bin.labels, sm.clim.bin = label_value)
varname <- 'SM'
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank())
g_plots
# sm bins...
sm.clim.bin.values <- as.numeric(levels(df_all_comb$sm.clim.bin))
sm.binwidth <- unique(diff(sm.clim.bin.values))/2
sm.binwidth
# sm bins...
sm.clim.bin.values <- as.numeric(levels(df_all_comb$sm.clim.bin))
sm.clim.bin.values
sm.binwidth <- unique(diff(sm.clim.bin.values))/2
# sm bins...
sm.clim.bin.values <- as.numeric(levels(df_all_comb$sm.clim.bin))
sm.binwidth <- unique(diff(sm.clim.bin.values))/2
sm.clim.bin.labels <- paste(sm.clim.bin.values - sm.binwidth, '<= SM <',
sm.clim.bin.values + sm.binwidth)
names(sm.clim.bin.labels) <- levels(df_all_comb$sm.clim.bin)
# labeller...
climbin_labeller <- labeller(
t2.clim.bin = t2.clim.bin.labels, sm.clim.bin = sm.clim.bin.labels)
# sm bins...
sm.clim.bin.values <- as.numeric(levels(df_all_comb$sm.clim.bin))
sm.binwidth <- unique(diff(sm.clim.bin.values))/2
sm.clim.bin.labels <- paste(sm.clim.bin.values - sm.binwidth, '<= SM <',
sm.clim.bin.values + sm.binwidth)
sm.clim.bin.values
sm.binwidth
diff(sm.clim.bin.values)
unique(diff(sm.clim.bin.values))
diff(t2.clim.bin.values)
unique(diff(t2.clim.bin.values))
diff(sm.clim.bin.values)
sm.binwidth <- unique(round(diff(sm.clim.bin.values), digits = 6))/2
sm.binwidth
sm.clim.bin.labels <- paste(sm.clim.bin.values - sm.binwidth, '<= SM <',
sm.clim.bin.values + sm.binwidth)
names(sm.clim.bin.labels) <- levels(df_all_comb$sm.clim.bin)
# labeller...
climbin_labeller <- labeller(
t2.clim.bin = t2.clim.bin.labels, sm.clim.bin = sm.clim.bin.labels)
varname <- 'SM'
varname_list <- c('SM', 'LST', 'albedo')
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank())
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 9))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
# t2m bins...
t2.clim.bin.values <- as.numeric(levels(df_all_comb$t2.clim.bin))
t2.binwidth <- unique(diff(t2.clim.bin.values))/2
t2.clim.bin.labels <- paste(t2.clim.bin.values - t2.binwidth, '< T2m <',
t2.clim.bin.values + t2.binwidth)
names(t2.clim.bin.labels) <- levels(df_all_comb$t2.clim.bin)
# sm bins...
sm.clim.bin.values <- as.numeric(levels(df_all_comb$sm.clim.bin))
sm.binwidth <- unique(round(diff(sm.clim.bin.values), digits = 6))/2
sm.clim.bin.labels <- paste(sm.clim.bin.values - sm.binwidth, '< SM <',
sm.clim.bin.values + sm.binwidth)
names(sm.clim.bin.labels) <- levels(df_all_comb$sm.clim.bin)
# labeller...
climbin_labeller <- labeller(
t2.clim.bin = t2.clim.bin.labels, sm.clim.bin = sm.clim.bin.labels)
varname <- 'SM'
var_range <- list('SM' = NULL,
'albedo' = c(-0.1,0.1),
'LST' = NULL)
var_range
var_range$SM
var_range$[varname]
var_range[[varname]]
varname <- 'albedo'
var_range[[varname]]
var_range <- list('SM' = NULL,
'albedo' = c(-0.1,0.1),
'LST' = NULL)
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]])
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
df_all_comb
# for(varname in varname_list){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
mk_plot <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins('SM')
mk_plot_allBins('albedo')
mk_plot_allBins('LST')
var_range <- list('SM' = NULL,
'albedo' = c(-0.05,0.05),
'LST' = NULL)
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins('albedo')
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21, size = 1) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
g_plots <- ggplot(df_all_comb %>%
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21, size = 1) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins('LST')
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', shape = 21, size = 1) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins('LST')
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
shape = 1, size = 1) +
# colour = 'grey35', shape = 21, size = 1) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
g_plots <- ggplot(df_all_comb %>%
g_plots
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey50') +
geom_vline(xintercept = 0, colour = 'grey50') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey35', stroke = 1, shape = 21, size = 1) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins('SM')
mk_plot_allBins('LST')
mk_plot_allBins('albedo')
varname <- 'SM'
varname_list <- c('SM', 'LST', 'albedo')
var_range <- list('SM' = NULL,
'albedo' = c(-0.05,0.05),
'LST' = NULL)
mk_plot_allBins <- function(varname){
g_plots <- ggplot(df_all_comb %>%
filter(y_var == varname) %>%
filter(!is.na(t2.clim.bin) & t2.clim.bin != 34) %>%
filter(!is.na(sm.clim.bin) & sm.clim.bin != 0)) +
geom_hline(yintercept = 0, colour = 'grey60') +
geom_vline(xintercept = 0, colour = 'grey60') +
geom_point(aes(x = dif_mu_LAI, y = y_mu, fill = monthS),
colour = 'grey45', stroke = 0.1, shape = 21, size = 1) +
facet_grid(t2.clim.bin~sm.clim.bin, labeller = climbin_labeller) +
scale_fill_gradientn('', colours = cols, breaks = 1:12, labels = month.abb) +
scale_y_continuous(paste('Bias in', varname, '(ERA - obs)')) +
scale_x_continuous('Bias in LAI (ERA - obs)') +
coord_cartesian(ylim = var_range[[varname]]) +
ggtitle(label = paste0('Patterns for selected variable: ', varname),
subtitle = 'Analysized per bins in a climate space of mean annual 2m Temperature vs. Soil Moisture') +
theme(legend.position = 'left',
legend.key.height = unit(3, units = 'cm'),
panel.grid = element_blank(),
strip.text = element_text(size = 6))
ggsave(filename = paste0('climspace_plot__', varname, '.', fig.format),
path = out.path, plot = g_plots, width = 16, height = 9)
}
mk_plot_allBins('SM')
mk_plot_allBins('LST')
mk_plot_allBins('albedo')

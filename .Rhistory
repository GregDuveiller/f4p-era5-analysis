ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% 'Aw')) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% 'Aw')) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% 'Af')) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
ggplot(df_LAI_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, fill = cz_name)) +
geom_ribbon(aes(ymin = LAI_dif_mu - LAI_dif_sd,
ymax = LAI_dif_mu + LAI_dif_sd),
alpha = 0.2) +
geom_line(aes(y = LAI_dif_mu, colour = cz_name),
linetype = 1, size = 1) +
geom_hline(yintercept = 0, colour = 'grey30') +
facet_wrap(~cz_name, nc = 1)   +
scale_colour_manual(values = cz_cols, guide = 'none') +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Difference in LAI') +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Bias in LAI for selected climate zones',
subtitle = '[LAI_reanalysis (ERA5) - LAI_observations (Theia)]')
ggplot(df_LAI_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, colour = cz_name)) +
geom_line(aes(y = LAI_obs_mu), linetype = 1) +
geom_line(aes(y = LAI_rea_mu), linetype = 2) +
scale_colour_manual(values = cz_cols, guide = 'none') +
facet_wrap(~cz_name, nc = 1)  +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Average LAI for selected climate zones',
subtitle = '[LAI reanalysis (ERA5) in dashed line, LAI observations (Theia) in full lines]')
sel_cz <- c('Cfc', 'BSh', 'Dfb', 'Af', 'ET')
ggplot(df_LAI_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, colour = cz_name)) +
geom_line(aes(y = LAI_obs_mu), linetype = 1) +
geom_line(aes(y = LAI_rea_mu), linetype = 2) +
scale_colour_manual(values = cz_cols, guide = 'none') +
facet_wrap(~cz_name, nc = 1)  +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Average LAI for selected climate zones',
subtitle = '[LAI reanalysis (ERA5) in dashed line, LAI observations (Theia) in full lines]')
ggplot(df_LAI_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, fill = cz_name)) +
geom_ribbon(aes(ymin = LAI_dif_mu - LAI_dif_sd,
ymax = LAI_dif_mu + LAI_dif_sd),
alpha = 0.2) +
geom_line(aes(y = LAI_dif_mu, colour = cz_name),
linetype = 1, size = 1) +
geom_hline(yintercept = 0, colour = 'grey30') +
facet_wrap(~cz_name, nc = 1)   +
scale_colour_manual(values = cz_cols, guide = 'none') +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Difference in LAI') +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Bias in LAI for selected climate zones',
subtitle = '[LAI_reanalysis (ERA5) - LAI_observations (Theia)]')
ggplot(df_LST_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, colour = cz_name)) +
geom_line(aes(y = LST_obs_mu), linetype = 1) +
geom_line(aes(y = LST_rea_mu), linetype = 2) +
scale_colour_manual(values = cz_cols, guide = 'none') +
facet_wrap(~cz_name, nc = 1)  +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Average LST for selected climate zones',
subtitle = '[LST reanalysis (ERA5) in dashed line, LST observations (Theia) in full lines]')
ggplot(df_LST_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, fill = cz_name)) +
geom_ribbon(aes(ymin = LST_dif_mu - LST_dif_sd,
ymax = LST_dif_mu + LST_dif_sd),
alpha = 0.2) +
geom_line(aes(y = LST_dif_mu, colour = cz_name),
linetype = 1, size = 1) +
geom_hline(yintercept = 0, colour = 'grey30') +
facet_wrap(~cz_name, nc = 1)   +
scale_colour_manual(values = cz_cols, guide = 'none') +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Difference in LST') +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Bias in LST for selected climate zones',
subtitle = '[LST_reanalysis (ERA5) - LST_observations (Theia)]')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% 'Af')) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% 'Aw')) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
sel_cz <- c('Aw', 'Cfa', 'Cwb', 'Dwa', 'Cwa', 'Dfa')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
require(ggplot2)
require(dplyr)
require(pals)
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_gradientn('Season', colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___temporal-devs-LAI.r')
df_all_comb <- left_join(df_LAI_comb,  df_LST_comb,
by = c("year", "monthS", "cz_name", "time"))
cz_cols <- df_lgd$cz_colours
names(cz_cols) <- df_lgd$cz_name
sel_cz <- c('Cfc', 'BSh', 'Dfb', 'Af', 'ET')
sel_cz <- c('Aw', 'Cfa', 'Cwb', 'Dwa', 'Cwa', 'Dfa')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_gradientn('Season', colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% 'Aw')) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
LST_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_sat', full.names = T) #"df_i_025"
LST_files
SKT_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_ERA5l', full.names = T)
SM_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_sat', full.names = T) #"df_i_025"
load('results/ancillary_info/df_KG_climatezones.RData') #  'df_cz' and 'df_lgd'
SM_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_ERA5l', full.names = T)
ifile <- SM_files[1]
(load(ifile))
ifile
SAT_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_sat', full.names = T) #"df_i_025"
load('results/ancillary_info/df_KG_climatezones.RData') #  'df_cz' and 'df_lgd'
ERA_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_ERA5l', full.names = T)
ifile <- SAT_files[1]
load(ifile); df_SMrs <- df
(load(gsub(ifile, pattern = 'SM_sat', replacement = 'SM_ERA5l')))
load(gsub(ifile, pattern = 'SM_sat', replacement = 'SM_ERA5l')); df_SMra <- df
head(df_SMra)
head(df_SMrs)
load(ifile); df_SMrs <- df
load(gsub(ifile, pattern = 'SM_sat', replacement = 'SM_ERA5l')); df_SMra <- df
df_SM <- df_SMrs %>%
#filter(`nobs` > 5) %>%
select(x, y, year, month, sm) %>%
# need to rotate cold months in Southern Hemisphere
mutate(monthS = ifelse(sign(y) < 0, (month + 6) %% 12, month))  %>%
mutate(monthS = ifelse(monthS == 0, 12, monthS)) %>%
left_join(df_SMra %>%
# need to rotate cold months in Southern Hemisphere
mutate(monthS = ifelse(sign(y) < 0, (month + 6) %% 12, month),
monthS = ifelse(monthS == 0, 12, monthS)),
by = c("x", "y", "month", "monthS", "year")) %>%
mutate(SM_difference = swvl1 - sm) %>%
left_join(df_cz,  by = c("x", "y")) %>%
group_by(year, monthS, cz_name) %>%
summarise(LST_obs_mu = mean(sm, na.rm = T),
LST_obs_sd = sd(sm, na.rm = T),
LST_rea_mu = mean(swvl1, na.rm = T),
LST_rea_sd = sd(swvl1, na.rm = T),
LST_dif_mu = mean(SM_difference, na.rm = T),
LST_dif_sd = sd(SM_difference, na.rm = T))
df_SM_comb <- bind_rows(df_SM_comb, df_SM)
df_SM_comb <- df_SM_comb %>%
mutate(time = as.Date(x = paste(year, monthS, '15', sep = '-')))
df_SM_comb
df_SM_comb <- data.frame()
load(ifile); df_SMrs <- df
load(gsub(ifile, pattern = 'SM_sat', replacement = 'SM_ERA5l')); df_SMra <- df
df_SM <- df_SMrs %>%
#filter(`nobs` > 5) %>%
select(x, y, year, month, sm) %>%
# need to rotate cold months in Southern Hemisphere
mutate(monthS = ifelse(sign(y) < 0, (month + 6) %% 12, month))  %>%
mutate(monthS = ifelse(monthS == 0, 12, monthS)) %>%
left_join(df_SMra %>%
# need to rotate cold months in Southern Hemisphere
mutate(monthS = ifelse(sign(y) < 0, (month + 6) %% 12, month),
monthS = ifelse(monthS == 0, 12, monthS)),
by = c("x", "y", "month", "monthS", "year")) %>%
mutate(SM_difference = swvl1 - sm) %>%
left_join(df_cz,  by = c("x", "y")) %>%
group_by(year, monthS, cz_name) %>%
summarise(LST_obs_mu = mean(sm, na.rm = T),
LST_obs_sd = sd(sm, na.rm = T),
LST_rea_mu = mean(swvl1, na.rm = T),
LST_rea_sd = sd(swvl1, na.rm = T),
LST_dif_mu = mean(SM_difference, na.rm = T),
LST_dif_sd = sd(SM_difference, na.rm = T))
df_SM_comb <- bind_rows(df_SM_comb, df_SM)
df_SM_comb <- df_SM_comb %>%
mutate(time = as.Date(x = paste(year, monthS, '15', sep = '-')))
cz_cols <- df_lgd$cz_colours
names(cz_cols) <- df_lgd$cz_name
ggplot(df_SM_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, colour = cz_name)) +
geom_line(aes(y = SM_obs_mu), linetype = 1) +
geom_line(aes(y = SM_rea_mu), linetype = 2) +
scale_colour_manual(values = cz_cols, guide = 'none') +
facet_wrap(~cz_name, nc = 1)  +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Average SM for selected climate zones',
subtitle = '[SM reanalysis (ERA5) in dashed line, SM observations (Theia) in full lines]')
df_SM_comb
head(df_SM)
ggplot(df_SM_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, colour = cz_name)) +
geom_line(aes(y = LST_obs_mu), linetype = 1) +
geom_line(aes(y = LST_rea_mu), linetype = 2) +
scale_colour_manual(values = cz_cols, guide = 'none') +
facet_wrap(~cz_name, nc = 1)  +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Average SM for selected climate zones',
subtitle = '[SM reanalysis (ERA5) in dashed line, SM observations (Theia) in full lines]')
source('~/work/workspace/f4p-era5-analysis/code/mkplots___temporal-devs-SM.R')
SAT_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_sat', full.names = T) #"df_i_025"
load('results/ancillary_info/df_KG_climatezones.RData') #  'df_cz' and 'df_lgd'
ERA_files <- list.files(path = 'data/r_data_frames',
pattern = 'SM_ERA5l', full.names = T)
df_SM_comb <- data.frame()
SM_files
source('~/work/workspace/f4p-era5-analysis/code/mkplots___temporal-devs-SM.R')
ggplot(df_SM_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, colour = cz_name)) +
geom_line(aes(y = SM_obs_mu), linetype = 1) +
geom_line(aes(y = SM_rea_mu), linetype = 2) +
scale_colour_manual(values = cz_cols, guide = 'none') +
facet_wrap(~cz_name, nc = 1)  +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Average SM for selected climate zones',
subtitle = '[SM reanalysis (ERA5) in dashed line, SM observations (Theia) in full lines]')
ggplot(df_SM_comb %>%
filter(cz_name %in% sel_cz),
aes(x = time, fill = cz_name)) +
geom_ribbon(aes(ymin = SM_dif_mu - SM_dif_sd,
ymax = SM_dif_mu + SM_dif_sd),
alpha = 0.2) +
geom_line(aes(y = SM_dif_mu, colour = cz_name),
linetype = 1, size = 1) +
geom_hline(yintercept = 0, colour = 'grey30') +
facet_wrap(~cz_name, nc = 1)   +
scale_colour_manual(values = cz_cols, guide = 'none') +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Difference in LST') +
scale_x_date('') +
coord_cartesian(expand = F) +
ggtitle(label = 'Bias in SM for selected climate zones',
subtitle = '[SM_reanalysis (ERA5) - SM_observations (Theia)]')
df_all_comb <- left_join(df_LAI_comb,  df_SM_comb,
by = c("year", "monthS", "cz_name", "time"))
cz_cols <- df_lgd$cz_colours
names(cz_cols) <- df_lgd$cz_name
sel_cz <- c('Cfc', 'BSh', 'Dfb', 'Af', 'ET')
sel_cz <- c('Aw', 'Cfa', 'Cwb', 'Dwa', 'Cwa', 'Dfa')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_gradientn('Season', colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is SM (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_gradientn('Season', colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is SM (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
sel_cz <- c('Aw', 'Cfa', 'Cwb', 'Dfb', 'Am', 'Cwc')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is SM (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_gradientn('Season', colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is SM (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 3) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is SM (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = SM_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 2) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is SM (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
head(df_SM)
df_all_comb <- left_join(df_LAI_comb,  df_LST_comb,
by = c("year", "monthS", "cz_name", "time"))
cz_cols <- df_lgd$cz_colours
names(cz_cols) <- df_lgd$cz_name
sel_cz <- c('Cfc', 'BSh', 'Dfb', 'Af', 'ET')
sel_cz <- c('Aw', 'Cfa', 'Cwb', 'Dfb', 'Am', 'Cwc')
# general plot for all climate zones
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = cz_name),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_manual(values = cz_cols, guide = 'none') +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
ggplot(df_all_comb) + # %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 4) +
scale_fill_gradientn('Season', colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
# plot for single climate zone with seasonality
ggplot(df_all_comb %>% filter(cz_name %in% sel_cz)) +
geom_point(aes(x = LAI_dif_mu, y = LST_dif_mu, fill = monthS),
colour = 'grey35', shape = 21) +
geom_hline(yintercept = 0, colour = 'grey20') +
geom_vline(xintercept = 0, colour = 'grey20') +
facet_wrap(~cz_name, nc = 2) +
scale_fill_gradientn(colours = kovesi.cyclic_mygbm_30_95_c78(12)) +
scale_y_continuous('Bias is LST (ERA - obs)') +
scale_x_continuous('Bias is LAI (ERA - obs)')
